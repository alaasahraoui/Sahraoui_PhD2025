\begin{figure}[h!]
    \centering
    \subfigure[Raw gesture sample (27pts)]{
        \begin{tikzpicture}
            \node[draw,circle,inner sep=1pt,fill,blue] (A1) at (0,0) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P1) at (0,.5) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P2) at (0,1.25) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P3) at (0,2.3) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P4) at (0,3) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P5) at (0,3.6) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (A2) at (0,4) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P6) at (.25,4) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P7) at (1,4) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P8) at (2.2,4) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P9) at (3.3,4) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P10) at (3.7,4) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (A3a) at (3.9,4) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (A3b) at (4,3.8) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P11) at (4,3.2) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P12) at (4,2.5) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P13) at (4,1.6) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P14) at (4,.9) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P15) at (4,.3) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (A4) at (4,0) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P16) at (3.8,0) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P17) at (3,0) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P18) at (2,0) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P19) at (1.3,0) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P20) at (.8,0) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P21) at (.35,0) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P22) at (.15,0) {};
        \end{tikzpicture}\label{fig:cdollar_raw}}
        \hspace{2.5cm}
    \subfigure[Resampled gesture (10pts)]{
        \begin{tikzpicture}
            \node[draw,circle,inner sep=1pt,fill,blue] (P1) at (0,0) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P2) at (0,1.6) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P3) at (0,3.2) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P4) at (1.39,4) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P5) at (2.99,4) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P6) at (4,2.75) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P7) at (4,1.15) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P8) at (2.87,0) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P9) at (1.27,0) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P10) at (.15,0) {};
        \end{tikzpicture}\label{fig:cdollar_resampling}}
    \subfigure[Centroid of the resampled gesture]{
        \begin{tikzpicture}
            \node[draw,circle,inner sep=1pt,fill,blue] (P1) at (0,0) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P2) at (0,1.6) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P3) at (0,3.2) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P4) at (1.39,4) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P5) at (2.99,4) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P6) at (4,2.75) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P7) at (4,1.15) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P8) at (2.87,0) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P9) at (1.27,0) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P10) at (.15,0) {};
            \node[draw,circle,inner sep=1pt,fill,red] (Cd) at (1.51,1.67) {};
            \node[red] (Centroid) [below left] at (1.51,1.67) {Cd};
        \end{tikzpicture}\label{fig:cdollar_centroid}}
    \hspace{2.5cm}
    \subfigure[Shapes (from first to last point)]{
        \begin{tikzpicture}
            \node[draw,circle,inner sep=1pt,fill,blue] (P1) at (0,0) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P2) at (0,1.6) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P3) at (0,3.2) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P4) at (1.39,4) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P5) at (2.99,4) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P6) at (4,2.75) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P7) at (4,1.15) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P8) at (2.87,0) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P9) at (1.27,0) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P10) at (.15,0) {};
            \node[draw,circle,inner sep=1pt,fill,red] (Cd) at (1.51,1.67) {};
            \node[red] (Centroid) [below left] at (1.51,1.67) {Cd};
            
            \draw[-latex] (P1)--(P2);
            \draw[-latex] (P2)--(P3);
            \draw[-latex] (P3)--(P4);
            \draw[-latex] (P4)--(P5);
            \draw[-latex] (P6)--(P7);
            \draw[-latex] (P7)--(P8);
            \draw[-latex] (P8)--(P9);
            \draw[-latex] (P9)--(P10);
            
            \draw[-latex] (Cd)--(P1);
            \draw[-latex] (Cd)--(P2);
            \draw[-latex] (Cd)--(P3);
            \draw[-latex] (Cd)--(P4);
            \draw[-latex] (Cd)--(P6);
            \draw[-latex] (Cd)--(P7);
            \draw[-latex] (Cd)--(P8);
            \draw[-latex] (Cd)--(P9);
            
            \begin{scope}[on background layer]
                \fill[gray!30] (Cd.center)--(P1.center)--(P2.center)--cycle;
                \fill[red!30] (Cd.center)--(P2.center)--(P3.center)--cycle;
                \fill[gray!30] (Cd.center)--(P3.center)--(P4.center)--cycle;
                \fill[red!30] (Cd.center)--(P4.center)--(P5.center)--cycle;
                
                \fill[gray!30] (Cd.center)--(P6.center)--(P7.center)--cycle;
                \fill[red!30] (Cd.center)--(P7.center)--(P8.center)--cycle;
                \fill[gray!30] (Cd.center)--(P8.center)--(P9.center)--cycle;
                \fill[red!30] (Cd.center)--(P9.center)--(P10.center)--cycle;
            \end{scope}
        \end{tikzpicture}\label{fig:cdollar_shapes}}
        \subfigure[Shapes (from last to first point)]{
        \begin{tikzpicture}
            \node[draw,circle,inner sep=1pt,fill,blue] (P1) at (0,0) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P2) at (0,1.6) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P3) at (0,3.2) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P4) at (1.39,4) {};
            \node[draw,circle,inner sep=1pt,fill,blue] (P5) at (2.99,4) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P6) at (4,2.75) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P7) at (4,1.15) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P8) at (2.87,0) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P9) at (1.27,0) {};
            \node[draw,circle,inner sep=1pt,fill,orange] (P10) at (.15,0) {};
            \node[draw,circle,inner sep=1pt,fill,red] (Cd) at (1.51,1.67) {};
            \node[red] (Centroid) [below left] at (1.51,1.67) {Cd};
            
            \draw[-latex] (P10)--(P9);
            \draw[-latex] (P9)--(P8);
            \draw[-latex] (P8)--(P7);
            \draw[-latex] (P7)--(P6);
            \draw[-latex] (P5)--(P4);
            \draw[-latex] (P4)--(P3);
            \draw[-latex] (P3)--(P2);
            \draw[-latex] (P2)--(P1);
            
            \draw[-latex] (Cd)--(P2);
            \draw[-latex] (Cd)--(P3);
            \draw[-latex] (Cd)--(P4);
            \draw[-latex] (Cd)--(P5);
            \draw[-latex] (Cd)--(P7);
            \draw[-latex] (Cd)--(P8);
            \draw[-latex] (Cd)--(P9);
            \draw[-latex] (Cd)--(P10);
            
            \begin{scope}[on background layer]
                \fill[green!30] (Cd.center)--(P1.center)--(P2.center)--cycle;
                \fill[yellow!30] (Cd.center)--(P2.center)--(P3.center)--cycle;
                \fill[green!30] (Cd.center)--(P3.center)--(P4.center)--cycle;
                \fill[yellow!30] (Cd.center)--(P4.center)--(P5.center)--cycle;
                
                \fill[green!30] (Cd.center)--(P6.center)--(P7.center)--cycle;
                \fill[yellow!30] (Cd.center)--(P7.center)--(P8.center)--cycle;
                \fill[green!30] (Cd.center)--(P8.center)--(P9.center)--cycle;
                \fill[yellow!30] (Cd.center)--(P9.center)--(P10.center)--cycle;
            \end{scope}
        \end{tikzpicture}\label{fig:cdollar_shapes2}}
        \caption{The preprocessing of a 2-stroke \enquote{square} sampled by 27 points, resampled with 10 points to compute 8 shapes, and whose strokes are respectively coloured in blue and orange.}
        \label{fig:cdollar}
\end{figure}